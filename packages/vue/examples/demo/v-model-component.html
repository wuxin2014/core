<script src="../../dist/vue.global.js"></script>
<script type="text/x-template" id="custom-comp">
  <input
    :value="modelValue"
    @input="$emit('update:modelValue', $event.target.value)"
  />
</script>
<script>
  const CustomComp = {
    template: '#custom-comp',
    props: ['modelValue'],
    emits: ['update:modelValue'],
    setup(props, { emit }) {
      const value = Vue.computed({
        get() {
          return props.modelValue
        },
        set(value) {
          emit('update:modelValue', value)
        }
      })

      return {
        value
      }
    }
  }
</script>

<script type="text/x-template" id="custom-comp2">
  <input type="text" :value="modelValue" @input="emitValue" />
</script>
<script>
  // v-model自定义的修饰符 capitalize == 3.4 之前的用法
  const CustomComp2 = {
    template: '#custom-comp2',
    props: {
      modelValue: String,
      modelModifiers: { default: () => ({}) }
    },
    emits: ['update:modelValue'],
    setup(props, { emit }) {
      const emitValue = (e) => {
        let value = e.target.value
        if (props.modelModifiers.capitalize) {
          value = value.charAt(0).toUpperCase() + value.slice(1)
        }
        emit('update:modelValue', value)
      }

      return {
        emitValue
      }
    }
  }
</script>

<script type="text/x-template" id="my-component">
  <input v-model="value" />
</script>
<script>
  const { computed } = Vue
  const MyComp = {
    template: '#my-component',
    props: ['title'],
    emits: ['update:title'],
    setup(props, { emit }) {
      const value = computed({
        get() {
          return props.title
        },
        set(value) {
          emit('update:title', value)
        }
      })

      return {
        value
      }
    }
  }
</script>

<!-- App template (in DOM) -->
<div id="demo">
  <div id="search">
    <h1>{{ name }}</h1>
    <custom-comp v-model="name"></custom-comp>
    <h1>{{ title }}</h1>
    <my-comp v-model:title="title"></my-comp>
    <h1>v-model自定义的修饰符 capitalize</h1>
    <custom-comp2 v-model.capitalize="name"></custom-comp2>
  </div>
</div>
<!-- App script -->
<script>
  debugger
  const { createApp, ref } = Vue
  createApp({
    components: { CustomComp, CustomComp2, MyComp },
    setup() {
      const name = ref('v-model指令')
      const title = ref('带参数title的v-model指令')
      return {
        name,
        title
      }
    }
  }).mount('#demo')

// (function anonymous() {
//   const _Vue = Vue
//   const { createVNode: _createVNode, createElementVNode: _createElementVNode, createCommentVNode: _createCommentVNode } = _Vue
//   const _hoisted_1 = { id: "search" }

//   return function render(_ctx, _cache) {
//     with (_ctx) {
//       const { createCommentVNode: _createCommentVNode, toDisplayString: _toDisplayString, createElementVNode: _createElementVNode, resolveComponent: _resolveComponent, createVNode: _createVNode, openBlock: _openBlock, createElementBlock: _createElementBlock } = _Vue

//       const _component_custom_comp = _resolveComponent("custom-comp")

//       return (_openBlock(), _createElementBlock("div", _hoisted_1, [
//         _createElementVNode("h1", null, _toDisplayString(name), 1 /* TEXT */),
//         _createVNode(_component_custom_comp, {
//           modelValue: name,
//           "onUpdate:modelValue": $event => ((name) = $event)
//         }, null, 8 /* PROPS */, ["modelValue", "onUpdate:modelValue"])
//       ]))
//     }
//   }
// })

// 子组件
// (function anonymous() {
//   const _Vue = Vue
//   const {  } = _Vue

//   const _hoisted_1 = ["value", "onInput"]

//   return function render(_ctx, _cache) {
//     with (_ctx) {
//       const { openBlock: _openBlock, createElementBlock: _createElementBlock } = _Vue

//       return (_openBlock(), _createElementBlock("input", {
//         value: modelValue,
//         onInput: $event => ($emit('update:modelValue', $event.target.value))
//       }, null, 40 /* PROPS, HYDRATE_EVENTS */, _hoisted_1))
//     }
//   }
// })
</script>

<style>
body {
  font-family: Helvetica Neue, Arial, sans-serif;
  font-size: 14px;
  color: #444;
}

.red {
    color: red;
}
</style>