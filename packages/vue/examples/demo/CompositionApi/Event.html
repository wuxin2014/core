<script src="../../../dist/vue.global.js"></script>
<script type="text/x-template" id="custom-comp">
  <button @click="handleClick">子组件中Button按钮</button>
</script>
<script>
  /**
   * emits的选项(不是必要的)，其作用：
   * 这声明了一个组件可能触发的所有事件，还可以对事件的参数进行验证
   * 还可以让 Vue 避免将它们作为原生事件监听器隐式地应用于子组件的根元素
   * 
   * 如果一个原生事件的名字 (例如 click) 被定义在 emits 选项中，则监听器只会监听组件触发的 click 事件而不会再响应原生的 click 事件。
   */ 
  const CustomComp = {
    template: '#custom-comp',
    emits: ['testEmit'], // 声明自定义事件
    setup(props, { emit }) {
      const handleClick = () => {
        debugger
        emit('testEmit', 'result')
      }
      return { handleClick }
    }
  }
  </script>
<!-- App template (in DOM) -->
<div id="demo">
  <div id="search">
    <div @click="handleClick">{{ callbackVal }}</div>
    <custom-comp @test-emit="handleCallback" />
  </div>
</div>
<!-- App script -->
<script>
Vue.createApp({
  components: {
    CustomComp
  },
  setup() {
    const callbackVal = Vue.ref('haha')
    const handleClick = () => {
      console.log('handleClick')
    }
    const handleCallback = (data) => {
      console.log('子组件事件回调===', data)
      callbackVal.value = data
    }
    return {
        callbackVal,
        handleClick,
        handleCallback 
    }
  }
}).mount('#demo')

// (function anonymous() {
//   const _Vue = Vue
//   const { createVNode: _createVNode, createElementVNode: _createElementVNode } = _Vue

//   const _hoisted_1 = { id: "search" }
//   const _hoisted_2 = ["onClick"]

//   return function render(_ctx, _cache) {
//     with (_ctx) {
//       const { toDisplayString: _toDisplayString, createElementVNode: _createElementVNode, resolveComponent: _resolveComponent, createVNode: _createVNode, openBlock: _openBlock, createElementBlock: _createElementBlock } = _Vue

//       const _component_custom_comp = _resolveComponent("custom-comp")

//       return (_openBlock(), _createElementBlock("div", _hoisted_1, [
//         _createElementVNode("div", { onClick: handleClick }, _toDisplayString(callbackVal), 9 /* TEXT, PROPS */, _hoisted_2),
//         _createVNode(_component_custom_comp, { onTestEmit: handleCallback }, null, 8 /* PROPS */, ["onTestEmit"]) // ["onTestEmit"] => dynamicProps
//       ]))
//     }
//   }
// })
</script>

<style>
body {
  font-family: Helvetica Neue, Arial, sans-serif;
  font-size: 14px;
  color: #444;
}

.red {
    color: red;
}
</style>