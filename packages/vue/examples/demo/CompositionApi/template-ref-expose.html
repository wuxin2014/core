<script src="../../../dist/vue.global.js"></script>
<script type="text/x-template" id="custom-comp">
  <div style="padding: 10px 0">
    <button @click="handleClick">子组件-{{count}}</button>
  </div>
</script>
<script>
  // expose 函数用于显式地限制该组件暴露出的属性，当父组件通过模板引用访问该组件的实例时，将仅能访问 expose 函数暴露出的内容：
  const Child = {
    template: '#custom-comp',
    setup(props, { expose }) {
      const count = Vue.ref(0)
      const handleClick = () => {
        count.value += 1
      }
      // 让组件实例处于 “关闭状态” 即不向父组件暴露任何东西
      // expose()

      // 有选择地暴露局部状态
      // expose({ count })
      return { count, handleClick }
    }
  }
  </script>
<!-- App template (in DOM) -->
<div id="demo">
  <button @click="handleClick">父组件-change-子组件值</button>
  <child ref="childRef"></child>
</div>
<script>
  const { createApp, ref } = Vue
  createApp({
    components: {
      Child
    },
    setup() {
      const childRef = ref()
      const handleClick = () => {
        // childRef.value => child组件实例
        console.log(childRef.value)
        childRef.value.count = 20 // 当父组件通过模板引用获取到了该组件的实例时，得到的实例类型(ref 都会自动解包，和一般的实例一样)。
      }
     
      return {
        childRef,
        handleClick
      }
    }
  }).mount('#demo')


  // (function anonymous() {
  //   const _Vue = Vue
  //   const { createVNode: _createVNode, createElementVNode: _createElementVNode } = _Vue

  //   const _hoisted_1 = ["onClick"]

  //   return function render(_ctx, _cache) {
  //     with (_ctx) {
  //       const { createElementVNode: _createElementVNode, resolveComponent: _resolveComponent, createVNode: _createVNode, Fragment: _Fragment, openBlock: _openBlock, createElementBlock: _createElementBlock } = _Vue

  //       const _component_custom_comp = _resolveComponent("custom-comp")

  //       return (_openBlock(), _createElementBlock(_Fragment, null, [
  //         _createElementVNode("button", { onClick: handleClick }, "父组件-change-子组件值", 8 /* PROPS */, _hoisted_1),
  //         _createVNode(_component_custom_comp, { ref: "cusRef" }, null, 512 /* NEED_PATCH */)
  //       ], 64 /* STABLE_FRAGMENT */))
  //     }
  //   }
  // })

  // (function anonymous() {
  //   const _Vue = Vue
  //   const { createElementVNode: _createElementVNode } = _Vue

  //   const _hoisted_1 = { style: {"padding":"10px 0"} }
  //   const _hoisted_2 = ["onClick"]

  //   return function render(_ctx, _cache) {
  //     with (_ctx) {
  //       const { toDisplayString: _toDisplayString, createElementVNode: _createElementVNode, openBlock: _openBlock, createElementBlock: _createElementBlock } = _Vue

  //       return (_openBlock(), _createElementBlock("div", _hoisted_1, [
  //         _createElementVNode("button", { onClick: handleClick }, "子组件-" + _toDisplayString(count), 9 /* TEXT, PROPS */, _hoisted_2)
  //       ]))
  //     }
  //   }
  // })
</script>

<style>
body {
  font-family: Helvetica Neue, Arial, sans-serif;
  font-size: 14px;
  color: #444;
}

.red {
    color: red;
}
</style>